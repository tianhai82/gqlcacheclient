!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("gqlcacheclient",[],t):"object"==typeof exports?exports.gqlcacheclient=t():e.gqlcacheclient=t()}(global,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=r(1),u=r(2);function s(e,t){var r=[];r.push(e.operation),r.push(e.name?e.name.value:null);var n=r.join("|");return e.selectionSet.selections.map(function(e){if("field"===e.kind.toLowerCase()){var r=e.alias?e.alias.value:e.name.value;return{queryKey:n+"|"+function e(t,r){if("field"===t.kind.toLowerCase()){var n=t.name.value;t.alias&&(n=t.alias.value+":"+n);var o=t.arguments.map(function(e){var t=e.name.value;return"variable"===e.value.kind.toLowerCase()&&r&&e.value.name&&r[e.value.name.value]?t+="="+JSON.stringify(r[e.value.name.value]):"variable"!==e.value.kind.toLowerCase()&&(t+="="+JSON.stringify(e.value.value)),t});return o.length>0&&(n+="("+o.join(" ")+")"),t.selectionSet&&t.selectionSet.selections&&0!==t.selectionSet.selections.length?n+"{"+t.selectionSet.selections.map(function(t){return e(t,r)}).join(" ")+"}":n}if("inlinefragment"===t.kind.toLowerCase()){var i="..."+t.typeCondition.name.value;return t.selectionSet&&t.selectionSet.selections&&0!==t.selectionSet.selections.length?i+"{"+t.selectionSet.selections.map(function(t){return e(t,r)}).join(" ")+"}":i}throw new Error("Selection is of unknown type")}(e,t),alias:r}}throw new Error('First level selections must be of kind "Field"')})}var l=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.endpoint=t,this.headers=r,this.cache=new Map,this.errorHandler=n}return o(e,[{key:"request",value:function(e,t,r){var o=this,l={cache:!0};r&&(l=i({},l,r));var c=void 0,f=!1;if("object"===(void 0===e?"undefined":n(e))&&e.kind&&"string"==typeof e.kind&&"document"===e.kind.toLowerCase()&&(f=!0),f)c=e;else try{if((c=(0,a.parse)(e)).definitions.length>1)return Promise.reject(new Error("Multiple operations not supported"))}catch(e){return Promise.reject(e)}var p=c.definitions[0],d=void 0;if(l.cache&&"query"===p.operation.toLowerCase()){try{d=s(p,t)}catch(e){return Promise.reject(e)}var v={},y=0;if(d.forEach(function(e){var t=o.cache.get(e.queryKey);t&&(v[e.alias]=t,y+=1)}),y===d.length)return Promise.resolve(v)}var h=function(e,t,r,n,o){return fetch(e,{method:"POST",cache:"no-cache",credentials:"same-origin",headers:i({"Content-Type":"application/json; charset=utf-8"},t),redirect:"follow",referrer:"no-referrer",body:JSON.stringify({operationName:r,query:n,variables:o})}).then(function(e){return e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject({networkError:{status:e.status,statusText:e.statusText}})}).then(function(e){return e.json()}).then(function(e){return e.errors&&e.errors.length>0?Promise.reject({graphqlErrors:e.errors}):Promise.resolve(e.data)})}(this.endpoint,this.headers,c.definitions[0].name?c.definitions[0].name.value:null,(0,u.print)(c),t).then(function(e){return l.cache&&"query"===p.operation.toLowerCase()&&d&&d.forEach(function(t){o.cache.set(t.queryKey,e[t.alias])}),Promise.resolve(e)});return this.errorHandler?h.catch(function(e){return o.errorHandler(e)}):h}}]),e}();t.default=l},function(e,t){e.exports=require("graphql")},function(e,t){e.exports=require("graphql/language/printer")}])});
//# sourceMappingURL=gqlcacheclient.min.js.map